#syntax=docker/dockerfile:1.2

FROM {{ b | docker_user }}/{{ b | docker_repo }}:{{ b | build }}-{{ b | image }}-{{ b | version }}
LABEL maintainer="{{ b | maintainer }}"

{% if 'apk' in b %}
{% include 'apk' %}
{% endif %}

{% include 'pyenv_python' %}

{% if 'npm' in b %}
{% include 'npm' %}
{% endif %}

{% if 'pip' in b %}
{% include 'pip' %}
{% endif %}

# RUN jupyter serverextension enable --sys-prefix nbgitpuller  && jupyter serverextension enable --sys-prefix jupyter_server_proxy && python -m sshkernel install --sys-prefix && python -m bash_kernel.install --sys-prefix  && jupyter serverextension enable --sys-prefix sshkernel && jupyter lab clean  -y && npm cache clean --force

USER {{ b | user }}
WORKDIR ${HOME}
