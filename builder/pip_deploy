#syntax=docker/dockerfile:1.2

FROM {{ b | user }}/{{ b | repo }}:{{ b | build }}-{{ b | stage }}-build-{{ b | version }} as build
FROM {{ b | user }}/{{ b | repo }}:{{ b | build }}-{{ b | image }}-{{ b |version }}

COPY --chown=${NB_USER} --from=build ${ENV_ROOT} ${ENV_ROOT}
COPY alpine.pkg alpine.pkg
RUN PKG=`cat alpine.pkg` && echo "Installing ${PKG}" &&  sudo apk add --no-cache ${PKG}
COPY --chown=${NB_USER} requirements.txt requirements.txt
RUN pip install -r requirements.txt